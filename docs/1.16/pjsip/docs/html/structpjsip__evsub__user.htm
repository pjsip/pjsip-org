<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PJSIP Reference: pjsip_evsub_user Struct Reference (1.16)</title>
<link href="/style/style.css" rel="stylesheet" type="text/css">
</head><body>
	<!--#include virtual="/header.html" -->
	<p><A HREF="/">Home</A> --&gt; <A HREF="/docs.htm">Documentations</A> --&gt; PJSIP Reference</p>

<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.htm"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.htm"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.htm"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.htm"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.htm"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.htm"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="functions.htm"><span>Data&nbsp;Fields</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<h1>pjsip_evsub_user Struct Reference<br/>
<small>
[<a class="el" href="group__PJSIP__EVENT__NOT.htm">SIP Event Notification (RFC 3265) Module</a>]</small>
</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="pjsip_evsub_user" -->
<p><code>#include &lt;evsub.h&gt;</code></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpjsip__evsub__user.htm#ac740cc29b827714ed5bf1cf955a9cc77">on_evsub_state</a> )(<a class="el" href="group__PJSIP__EVENT__NOT.htm#gabef75338a5839ec42984bdf37b54a093">pjsip_evsub</a> *sub, <a class="el" href="structpjsip__event.htm">pjsip_event</a> *event)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpjsip__evsub__user.htm#ada78d48ce544373ee897df5da01e27f3">on_tsx_state</a> )(<a class="el" href="group__PJSIP__EVENT__NOT.htm#gabef75338a5839ec42984bdf37b54a093">pjsip_evsub</a> *sub, <a class="el" href="structpjsip__transaction.htm">pjsip_transaction</a> *tsx, <a class="el" href="structpjsip__event.htm">pjsip_event</a> *event)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpjsip__evsub__user.htm#adaf3bae369d1f2cec77cd9cc0bdb2d13">on_rx_refresh</a> )(<a class="el" href="group__PJSIP__EVENT__NOT.htm#gabef75338a5839ec42984bdf37b54a093">pjsip_evsub</a> *sub, <a class="el" href="structpjsip__rx__data.htm">pjsip_rx_data</a> *rdata, <a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__THREAD.htm#gab600dc33a20a0f36550a4538506d020e">int</a> *p_st_code, <a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/structpj__str__t.htm">pj_str_t</a> **p_st_text, <a class="el" href="structpjsip__hdr.htm">pjsip_hdr</a> *res_hdr, <a class="el" href="structpjsip__msg__body.htm">pjsip_msg_body</a> **p_body)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpjsip__evsub__user.htm#a172e0b620c527e5e574a80809b317d5c">on_rx_notify</a> )(<a class="el" href="group__PJSIP__EVENT__NOT.htm#gabef75338a5839ec42984bdf37b54a093">pjsip_evsub</a> *sub, <a class="el" href="structpjsip__rx__data.htm">pjsip_rx_data</a> *rdata, <a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__THREAD.htm#gab600dc33a20a0f36550a4538506d020e">int</a> *p_st_code, <a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/structpj__str__t.htm">pj_str_t</a> **p_st_text, <a class="el" href="structpjsip__hdr.htm">pjsip_hdr</a> *res_hdr, <a class="el" href="structpjsip__msg__body.htm">pjsip_msg_body</a> **p_body)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpjsip__evsub__user.htm#ab2c8470d69b4feda92a9d36923e6253a">on_client_refresh</a> )(<a class="el" href="group__PJSIP__EVENT__NOT.htm#gabef75338a5839ec42984bdf37b54a093">pjsip_evsub</a> *sub)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpjsip__evsub__user.htm#a45e8ee5b0f001b9284ca3a063d5d26e0">on_server_timeout</a> )(<a class="el" href="group__PJSIP__EVENT__NOT.htm#gabef75338a5839ec42984bdf37b54a093">pjsip_evsub</a> *sub)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This structure describes callback that is registered by application or package to receive notifications about subscription events.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="structpjsip__evsub__user.htm">pjsip_evsub_user</a> </dd></dl>
<hr/><h2>Field Documentation</h2>
<a class="anchor" id="ac740cc29b827714ed5bf1cf955a9cc77"></a><!-- doxytag: member="pjsip_evsub_user::on_evsub_state" ref="ac740cc29b827714ed5bf1cf955a9cc77" args=")(pjsip_evsub *sub, pjsip_event *event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structpjsip__evsub__user.htm#ac740cc29b827714ed5bf1cf955a9cc77">pjsip_evsub_user::on_evsub_state</a>)(<a class="el" href="group__PJSIP__EVENT__NOT.htm#gabef75338a5839ec42984bdf37b54a093">pjsip_evsub</a> *sub, <a class="el" href="structpjsip__event.htm">pjsip_event</a> *event)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This callback is called when subscription state has changed. Application MUST be prepared to receive NULL event and events with type other than PJSIP_EVENT_TSX_STATE</p>
<p>This callback is OPTIONAL.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sub</em>&nbsp;</td><td>The subscription instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>The event that has caused the state to change, which may be NULL or may have type other than PJSIP_EVENT_TSX_STATE. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ada78d48ce544373ee897df5da01e27f3"></a><!-- doxytag: member="pjsip_evsub_user::on_tsx_state" ref="ada78d48ce544373ee897df5da01e27f3" args=")(pjsip_evsub *sub, pjsip_transaction *tsx, pjsip_event *event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structpjsip__evsub__user.htm#ada78d48ce544373ee897df5da01e27f3">pjsip_evsub_user::on_tsx_state</a>)(<a class="el" href="group__PJSIP__EVENT__NOT.htm#gabef75338a5839ec42984bdf37b54a093">pjsip_evsub</a> *sub, <a class="el" href="structpjsip__transaction.htm">pjsip_transaction</a> *tsx, <a class="el" href="structpjsip__event.htm">pjsip_event</a> *event)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This callback is called when transaction state has changed.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sub</em>&nbsp;</td><td>The subscription instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tsx</em>&nbsp;</td><td>Transaction. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>The event. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="adaf3bae369d1f2cec77cd9cc0bdb2d13"></a><!-- doxytag: member="pjsip_evsub_user::on_rx_refresh" ref="adaf3bae369d1f2cec77cd9cc0bdb2d13" args=")(pjsip_evsub *sub, pjsip_rx_data *rdata, int *p_st_code, pj_str_t **p_st_text, pjsip_hdr *res_hdr, pjsip_msg_body **p_body)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structpjsip__evsub__user.htm#adaf3bae369d1f2cec77cd9cc0bdb2d13">pjsip_evsub_user::on_rx_refresh</a>)(<a class="el" href="group__PJSIP__EVENT__NOT.htm#gabef75338a5839ec42984bdf37b54a093">pjsip_evsub</a> *sub, <a class="el" href="structpjsip__rx__data.htm">pjsip_rx_data</a> *rdata, <a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__THREAD.htm#gab600dc33a20a0f36550a4538506d020e">int</a> *p_st_code, <a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/structpj__str__t.htm">pj_str_t</a> **p_st_text, <a class="el" href="structpjsip__hdr.htm">pjsip_hdr</a> *res_hdr, <a class="el" href="structpjsip__msg__body.htm">pjsip_msg_body</a> **p_body)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This callback is called when incoming SUBSCRIBE (or any method that establishes the subscription in the first place) is received. It allows application to specify what response should be sent to remote, along with additional headers and message body to be put in the response.</p>
<p>This callback is OPTIONAL.</p>
<p>However, implementation MUST send NOTIFY request upon receiving this callback. The suggested behavior is to call <a class="el" href="group__PJSIP__EVENT__NOT.htm#ga981bc5f30ffa5311f12d559ca76eb4f0">pjsip_evsub_current_notify()</a>, since this function takes care about unsubscription request and calculates the appropriate expiration interval. </p>

</div>
</div>
<a class="anchor" id="a172e0b620c527e5e574a80809b317d5c"></a><!-- doxytag: member="pjsip_evsub_user::on_rx_notify" ref="a172e0b620c527e5e574a80809b317d5c" args=")(pjsip_evsub *sub, pjsip_rx_data *rdata, int *p_st_code, pj_str_t **p_st_text, pjsip_hdr *res_hdr, pjsip_msg_body **p_body)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structpjsip__evsub__user.htm#a172e0b620c527e5e574a80809b317d5c">pjsip_evsub_user::on_rx_notify</a>)(<a class="el" href="group__PJSIP__EVENT__NOT.htm#gabef75338a5839ec42984bdf37b54a093">pjsip_evsub</a> *sub, <a class="el" href="structpjsip__rx__data.htm">pjsip_rx_data</a> *rdata, <a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__THREAD.htm#gab600dc33a20a0f36550a4538506d020e">int</a> *p_st_code, <a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/structpj__str__t.htm">pj_str_t</a> **p_st_text, <a class="el" href="structpjsip__hdr.htm">pjsip_hdr</a> *res_hdr, <a class="el" href="structpjsip__msg__body.htm">pjsip_msg_body</a> **p_body)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This callback is called when client/subscriber received incoming NOTIFY request. It allows the application to specify what response should be sent to remote, along with additional headers and message body to be put in the response.</p>
<p>This callback is OPTIONAL. When it is not implemented, the default behavior is to respond incoming NOTIFY request with 200 (OK).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sub</em>&nbsp;</td><td>The subscription instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rdata</em>&nbsp;</td><td>The received NOTIFY request. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>p_st_code</em>&nbsp;</td><td>Application MUST set the value of this argument with final status code (200-699) upon returning from the callback. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>p_st_text</em>&nbsp;</td><td>Custom status text, if any. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>res_hdr</em>&nbsp;</td><td>Upon return, application can put additional headers to be sent in the response in this list. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>p_body</em>&nbsp;</td><td>Application MAY specify message body to be sent in the response. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab2c8470d69b4feda92a9d36923e6253a"></a><!-- doxytag: member="pjsip_evsub_user::on_client_refresh" ref="ab2c8470d69b4feda92a9d36923e6253a" args=")(pjsip_evsub *sub)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structpjsip__evsub__user.htm#ab2c8470d69b4feda92a9d36923e6253a">pjsip_evsub_user::on_client_refresh</a>)(<a class="el" href="group__PJSIP__EVENT__NOT.htm#gabef75338a5839ec42984bdf37b54a093">pjsip_evsub</a> *sub)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This callback is called when it is time for the client to refresh the subscription.</p>
<p>This callback is OPTIONAL when PJSIP package such as presence or refer is used; the event package will refresh subscription by sending SUBSCRIBE with the interval set to current/last interval.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sub</em>&nbsp;</td><td>The subscription instance. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a45e8ee5b0f001b9284ca3a063d5d26e0"></a><!-- doxytag: member="pjsip_evsub_user::on_server_timeout" ref="a45e8ee5b0f001b9284ca3a063d5d26e0" args=")(pjsip_evsub *sub)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structpjsip__evsub__user.htm#a45e8ee5b0f001b9284ca3a063d5d26e0">pjsip_evsub_user::on_server_timeout</a>)(<a class="el" href="group__PJSIP__EVENT__NOT.htm#gabef75338a5839ec42984bdf37b54a093">pjsip_evsub</a> *sub)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This callback is called when server doesn't receive subscription refresh after the specified subscription interval.</p>
<p>This callback is OPTIONAL when PJSIP package such as presence or refer is used; the event package send NOTIFY to terminate the subscription. </p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="evsub_8h.htm">evsub.h</a></li>
</ul>
</div>
<p>&nbsp;</p>
<hr><center>
PJSIP Open Source, high performance, small footprint, and very very portable SIP stack<br>
Copyright (C) 2006-2008 Teluu Inc.
</center>
<!--#include virtual="/footer.html" -->

</BODY>
</HTML>
