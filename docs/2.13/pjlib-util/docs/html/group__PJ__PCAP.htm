<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Simple PCAP file reader (2.13)</title>
<link href="/style/style.css" rel="stylesheet" type="text/css">
</head><body>
	<!--#include virtual="/header.html" -->
	<p><A HREF="/">Home</A> --&gt; <A HREF="/docs.htm">Documentations</A> --&gt; PJLIB-UTIL Reference</p>
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Simple PCAP file reader<div class="ingroups"><a class="el" href="group__PJ__FILE__FMT.htm">File Formats</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpj__pcap__udp__hdr.htm">pj_pcap_udp_hdr</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpj__pcap__filter.htm">pj_pcap_filter</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga3861e0fb989f9378365ba0e90a85eb84"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a></td></tr>
<tr class="separator:ga3861e0fb989f9378365ba0e90a85eb84"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga765482dceae438725d8dd5e894c0b153"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#ga765482dceae438725d8dd5e894c0b153">pj_pcap_link_type</a> { <a class="el" href="group__PJ__PCAP.htm#gga765482dceae438725d8dd5e894c0b153a736ebaa623e8bd55751bf3765dddb3f6">PJ_PCAP_LINK_TYPE_ETH</a> = 1
 }</td></tr>
<tr class="separator:ga765482dceae438725d8dd5e894c0b153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf0c3c18d264710ca896b13521e886a8b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#gaf0c3c18d264710ca896b13521e886a8b">pj_pcap_proto_type</a> { <a class="el" href="group__PJ__PCAP.htm#ggaf0c3c18d264710ca896b13521e886a8ba96c01b1aaf418fa6d4a8af310d1d6056">PJ_PCAP_PROTO_TYPE_UDP</a> = 17
 }</td></tr>
<tr class="separator:gaf0c3c18d264710ca896b13521e886a8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga656d69d66044f28a51d068ceed191551"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#ga656d69d66044f28a51d068ceed191551">pj_pcap_filter_default</a> (<a class="el" href="structpj__pcap__filter.htm">pj_pcap_filter</a> *filter)</td></tr>
<tr class="separator:ga656d69d66044f28a51d068ceed191551"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga363959786545a85bd8570b5ed12d9fbd"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#ga363959786545a85bd8570b5ed12d9fbd">pj_pcap_open</a> (<a class="elRef" href="../../../pjlib/docs/html/structpj__pool__t.htm">pj_pool_t</a> *pool, const char *path, <a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> **p_file)</td></tr>
<tr class="separator:ga363959786545a85bd8570b5ed12d9fbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad181000c921ab3fc2fcc5787c884c196"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#gad181000c921ab3fc2fcc5787c884c196">pj_pcap_close</a> (<a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> *file)</td></tr>
<tr class="separator:gad181000c921ab3fc2fcc5787c884c196"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad439d95c5e1cc08f0d6a1f2973faeb65"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#gad439d95c5e1cc08f0d6a1f2973faeb65">pj_pcap_set_filter</a> (<a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> *file, const <a class="el" href="structpj__pcap__filter.htm">pj_pcap_filter</a> *filter)</td></tr>
<tr class="separator:gad439d95c5e1cc08f0d6a1f2973faeb65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaed1c5d9e193b064f1a0917c22d3661be"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#gaed1c5d9e193b064f1a0917c22d3661be">pj_pcap_read_udp</a> (<a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> *file, <a class="el" href="structpj__pcap__udp__hdr.htm">pj_pcap_udp_hdr</a> *udp_hdr, <a class="elRef" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#ga03cd006c29b1d24580f5df4db912749e">pj_uint8_t</a> *udp_payload, <a class="elRef" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#ga9fdb3ceb491cd888cd30ca30d78026e8">pj_size_t</a> *udp_payload_size)</td></tr>
<tr class="separator:gaed1c5d9e193b064f1a0917c22d3661be"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >This module describes simple utility to read PCAP file. It is not intended to support all PCAP features (that's what libpcap is for!), but it can be useful for example to playback or stream PCAP contents. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga3861e0fb989f9378365ba0e90a85eb84" name="ga3861e0fb989f9378365ba0e90a85eb84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3861e0fb989f9378365ba0e90a85eb84">&#9670;&nbsp;</a></span>pj_pcap_file</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> <a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Opaque declaration for PCAP file </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga765482dceae438725d8dd5e894c0b153" name="ga765482dceae438725d8dd5e894c0b153"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga765482dceae438725d8dd5e894c0b153">&#9670;&nbsp;</a></span>pj_pcap_link_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__PJ__PCAP.htm#ga765482dceae438725d8dd5e894c0b153">pj_pcap_link_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Enumeration to describe supported data link types. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga765482dceae438725d8dd5e894c0b153a736ebaa623e8bd55751bf3765dddb3f6" name="gga765482dceae438725d8dd5e894c0b153a736ebaa623e8bd55751bf3765dddb3f6"></a>PJ_PCAP_LINK_TYPE_ETH&#160;</td><td class="fielddoc"><p >Ethernet data link </p>
</td></tr>
</table>

</div>
</div>
<a id="gaf0c3c18d264710ca896b13521e886a8b" name="gaf0c3c18d264710ca896b13521e886a8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf0c3c18d264710ca896b13521e886a8b">&#9670;&nbsp;</a></span>pj_pcap_proto_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__PJ__PCAP.htm#gaf0c3c18d264710ca896b13521e886a8b">pj_pcap_proto_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Enumeration to describe supported protocol types. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ggaf0c3c18d264710ca896b13521e886a8ba96c01b1aaf418fa6d4a8af310d1d6056" name="ggaf0c3c18d264710ca896b13521e886a8ba96c01b1aaf418fa6d4a8af310d1d6056"></a>PJ_PCAP_PROTO_TYPE_UDP&#160;</td><td class="fielddoc"><p >UDP protocol </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gad181000c921ab3fc2fcc5787c884c196" name="gad181000c921ab3fc2fcc5787c884c196"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad181000c921ab3fc2fcc5787c884c196">&#9670;&nbsp;</a></span>pj_pcap_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a> pj_pcap_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> *&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Close PCAP file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>PCAP file handle.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PJ_SUCCESS on success, or the appropriate error code. </dd></dl>

</div>
</div>
<a id="ga656d69d66044f28a51d068ceed191551" name="ga656d69d66044f28a51d068ceed191551"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga656d69d66044f28a51d068ceed191551">&#9670;&nbsp;</a></span>pj_pcap_filter_default()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pj_pcap_filter_default </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structpj__pcap__filter.htm">pj_pcap_filter</a> *&#160;</td>
          <td class="paramname"><em>filter</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Initialize filter with default values. The default value is to allow any packets.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filter</td><td>Filter to be initialized. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga363959786545a85bd8570b5ed12d9fbd" name="ga363959786545a85bd8570b5ed12d9fbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga363959786545a85bd8570b5ed12d9fbd">&#9670;&nbsp;</a></span>pj_pcap_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a> pj_pcap_open </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" href="../../../pjlib/docs/html/structpj__pool__t.htm">pj_pool_t</a> *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> **&#160;</td>
          <td class="paramname"><em>p_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Open PCAP file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td>Pool to allocate memory. </td></tr>
    <tr><td class="paramname">path</td><td>File/path name. </td></tr>
    <tr><td class="paramname">p_file</td><td>Pointer to receive PCAP file handle.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PJ_SUCCESS if file can be opened successfully. </dd></dl>

</div>
</div>
<a id="gaed1c5d9e193b064f1a0917c22d3661be" name="gaed1c5d9e193b064f1a0917c22d3661be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaed1c5d9e193b064f1a0917c22d3661be">&#9670;&nbsp;</a></span>pj_pcap_read_udp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a> pj_pcap_read_udp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpj__pcap__udp__hdr.htm">pj_pcap_udp_hdr</a> *&#160;</td>
          <td class="paramname"><em>udp_hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#ga03cd006c29b1d24580f5df4db912749e">pj_uint8_t</a> *&#160;</td>
          <td class="paramname"><em>udp_payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#ga9fdb3ceb491cd888cd30ca30d78026e8">pj_size_t</a> *&#160;</td>
          <td class="paramname"><em>udp_payload_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Read UDP payload from the next packet in the PCAP file. Optionally it can return the UDP header, if caller supplies it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>PCAP file handle. </td></tr>
    <tr><td class="paramname">udp_hdr</td><td>Optional buffer to receive UDP header. </td></tr>
    <tr><td class="paramname">udp_payload</td><td>Buffer to receive the UDP payload. </td></tr>
    <tr><td class="paramname">udp_payload_size</td><td>On input, specify the size of the buffer. On output, it will be filled with the actual size of the payload as read from the packet.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PJ_SUCCESS on success, or the appropriate error code. </dd></dl>

<p class="reference">References <a class="elRef" href="../../../pjlib/docs/html/group__pj__config.htm#gac961f7d199eeed7666ab3ec2442c1b00">PJ_END_DECL</a>.</p>

</div>
</div>
<a id="gad439d95c5e1cc08f0d6a1f2973faeb65" name="gad439d95c5e1cc08f0d6a1f2973faeb65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad439d95c5e1cc08f0d6a1f2973faeb65">&#9670;&nbsp;</a></span>pj_pcap_set_filter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a> pj_pcap_set_filter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpj__pcap__filter.htm">pj_pcap_filter</a> *&#160;</td>
          <td class="paramname"><em>filter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Configure filter for reading the file. When filter is configured, only packets matching all the filter settings will be returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>PCAP file handle. </td></tr>
    <tr><td class="paramname">filter</td><td>The filter.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PJ_SUCCESS on success, or the appropriate error code. </dd></dl>

</div>
</div>
</div><!-- contents -->
<p>&nbsp;</p>
<hr><center>
PJLIB-UTIL Open Source, small footprint, and portable asynchronous/caching DNS resolver, text scanner, STUN client, and XML library<br>
Copyright (C) 2006-2009 Teluu Inc.
</center>
<!--#include virtual="/footer.html" -->
</BODY>
</HTML>
