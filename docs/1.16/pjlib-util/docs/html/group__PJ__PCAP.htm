<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PJLIB-UTIL Reference: Simple PCAP file reader (1.16)</title>
<link href="/style/style.css" rel="stylesheet" type="text/css">
</head><body>
	<!--#include virtual="/header.html" -->
	<p><A HREF="/">Home</A> --&gt; <A HREF="/docs.htm">Documentations</A> --&gt; PJLIB-UTIL Reference</p>


<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.htm"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.htm"><span>Modules</span></a></li>
      <li><a href="annotated.htm"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.htm"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>Simple PCAP file reader<br/>
<small>
[<a class="el" href="group__PJ__FILE__FMT.htm">File Formats</a>]</small>
</h1>  </div>
</div>
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpj__pcap__udp__hdr.htm">pj_pcap_udp_hdr</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpj__pcap__filter.htm">pj_pcap_filter</a></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a></td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#ga765482dceae438725d8dd5e894c0b153">pj_pcap_link_type</a> { <a class="el" href="group__PJ__PCAP.htm#gga765482dceae438725d8dd5e894c0b153a736ebaa623e8bd55751bf3765dddb3f6">PJ_PCAP_LINK_TYPE_ETH</a> =  1
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#gaf0c3c18d264710ca896b13521e886a8b">pj_pcap_proto_type</a> { <a class="el" href="group__PJ__PCAP.htm#ggaf0c3c18d264710ca896b13521e886a8ba96c01b1aaf418fa6d4a8af310d1d6056">PJ_PCAP_PROTO_TYPE_UDP</a> =  17
 }</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#ga656d69d66044f28a51d068ceed191551">pj_pcap_filter_default</a> (<a class="el" href="structpj__pcap__filter.htm">pj_pcap_filter</a> *filter)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#ga363959786545a85bd8570b5ed12d9fbd">pj_pcap_open</a> (<a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/structpj__pool__t.htm">pj_pool_t</a> *pool, const char *path, <a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> **p_file)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#gad181000c921ab3fc2fcc5787c884c196">pj_pcap_close</a> (<a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> *file)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#gad439d95c5e1cc08f0d6a1f2973faeb65">pj_pcap_set_filter</a> (<a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> *file, const <a class="el" href="structpj__pcap__filter.htm">pj_pcap_filter</a> *filter)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__PCAP.htm#gaed1c5d9e193b064f1a0917c22d3661be">pj_pcap_read_udp</a> (<a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> *file, <a class="el" href="structpj__pcap__udp__hdr.htm">pj_pcap_udp_hdr</a> *udp_hdr, <a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#ga03cd006c29b1d24580f5df4db912749e">pj_uint8_t</a> *udp_payload, <a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#ga9fdb3ceb491cd888cd30ca30d78026e8">pj_size_t</a> *udp_payload_size)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This module describes simple utility to read PCAP file. It is not intended to support all PCAP features (that's what libpcap is for!), but it can be useful for example to playback or stream PCAP contents. </p>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="ga3861e0fb989f9378365ba0e90a85eb84"></a><!-- doxytag: member="pcap.h::pj_pcap_file" ref="ga3861e0fb989f9378365ba0e90a85eb84" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> <a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Opaque declaration for PCAP file </p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="ga765482dceae438725d8dd5e894c0b153"></a><!-- doxytag: member="pcap.h::pj_pcap_link_type" ref="ga765482dceae438725d8dd5e894c0b153" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__PJ__PCAP.htm#ga765482dceae438725d8dd5e894c0b153">pj_pcap_link_type</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Enumeration to describe supported data link types. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga765482dceae438725d8dd5e894c0b153a736ebaa623e8bd55751bf3765dddb3f6"></a><!-- doxytag: member="PJ_PCAP_LINK_TYPE_ETH" ref="gga765482dceae438725d8dd5e894c0b153a736ebaa623e8bd55751bf3765dddb3f6" args="" -->PJ_PCAP_LINK_TYPE_ETH</em>&nbsp;</td><td>
<p>Ethernet data link </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="gaf0c3c18d264710ca896b13521e886a8b"></a><!-- doxytag: member="pcap.h::pj_pcap_proto_type" ref="gaf0c3c18d264710ca896b13521e886a8b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__PJ__PCAP.htm#gaf0c3c18d264710ca896b13521e886a8b">pj_pcap_proto_type</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Enumeration to describe supported protocol types. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggaf0c3c18d264710ca896b13521e886a8ba96c01b1aaf418fa6d4a8af310d1d6056"></a><!-- doxytag: member="PJ_PCAP_PROTO_TYPE_UDP" ref="ggaf0c3c18d264710ca896b13521e886a8ba96c01b1aaf418fa6d4a8af310d1d6056" args="" -->PJ_PCAP_PROTO_TYPE_UDP</em>&nbsp;</td><td>
<p>UDP protocol </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gad181000c921ab3fc2fcc5787c884c196"></a><!-- doxytag: member="pcap.h::pj_pcap_close" ref="gad181000c921ab3fc2fcc5787c884c196" args="(pj_pcap_file *file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a> pj_pcap_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> *&nbsp;</td>
          <td class="paramname"> <em>file</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Close PCAP file.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>file</em>&nbsp;</td><td>PCAP file handle.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>PJ_SUCCESS on success, or the appropriate error code. </dd></dl>

</div>
</div>
<a class="anchor" id="ga656d69d66044f28a51d068ceed191551"></a><!-- doxytag: member="pcap.h::pj_pcap_filter_default" ref="ga656d69d66044f28a51d068ceed191551" args="(pj_pcap_filter *filter)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pj_pcap_filter_default </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structpj__pcap__filter.htm">pj_pcap_filter</a> *&nbsp;</td>
          <td class="paramname"> <em>filter</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialize filter with default values. The default value is to allow any packets.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>filter</em>&nbsp;</td><td>Filter to be initialized. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga363959786545a85bd8570b5ed12d9fbd"></a><!-- doxytag: member="pcap.h::pj_pcap_open" ref="ga363959786545a85bd8570b5ed12d9fbd" args="(pj_pool_t *pool, const char *path, pj_pcap_file **p_file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a> pj_pcap_open </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/structpj__pool__t.htm">pj_pool_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> **&nbsp;</td>
          <td class="paramname"> <em>p_file</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Open PCAP file.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pool</em>&nbsp;</td><td>Pool to allocate memory. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>path</em>&nbsp;</td><td>File/path name. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>p_file</em>&nbsp;</td><td>Pointer to receive PCAP file handle.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>PJ_SUCCESS if file can be opened successfully. </dd></dl>

</div>
</div>
<a class="anchor" id="gaed1c5d9e193b064f1a0917c22d3661be"></a><!-- doxytag: member="pcap.h::pj_pcap_read_udp" ref="gaed1c5d9e193b064f1a0917c22d3661be" args="(pj_pcap_file *file, pj_pcap_udp_hdr *udp_hdr, pj_uint8_t *udp_payload, pj_size_t *udp_payload_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a> pj_pcap_read_udp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpj__pcap__udp__hdr.htm">pj_pcap_udp_hdr</a> *&nbsp;</td>
          <td class="paramname"> <em>udp_hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#ga03cd006c29b1d24580f5df4db912749e">pj_uint8_t</a> *&nbsp;</td>
          <td class="paramname"> <em>udp_payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#ga9fdb3ceb491cd888cd30ca30d78026e8">pj_size_t</a> *&nbsp;</td>
          <td class="paramname"> <em>udp_payload_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Read UDP payload from the next packet in the PCAP file. Optionally it can return the UDP header, if caller supplies it.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>file</em>&nbsp;</td><td>PCAP file handle. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>udp_hdr</em>&nbsp;</td><td>Optional buffer to receive UDP header. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>udp_payload</em>&nbsp;</td><td>Buffer to receive the UDP payload. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>udp_payload_size</em>&nbsp;</td><td>On input, specify the size of the buffer. On output, it will be filled with the actual size of the payload as read from the packet.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>PJ_SUCCESS on success, or the appropriate error code. </dd></dl>

</div>
</div>
<a class="anchor" id="gad439d95c5e1cc08f0d6a1f2973faeb65"></a><!-- doxytag: member="pcap.h::pj_pcap_set_filter" ref="gad439d95c5e1cc08f0d6a1f2973faeb65" args="(pj_pcap_file *file, const pj_pcap_filter *filter)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" doxygen="pjlib.tag:../../../pjlib/docs/html/" href="../../../pjlib/docs/html/group__PJ__BASIC.htm#gab43ba3167bd2a2ab4580509dbf79200e">pj_status_t</a> pj_pcap_set_filter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__PJ__PCAP.htm#ga3861e0fb989f9378365ba0e90a85eb84">pj_pcap_file</a> *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpj__pcap__filter.htm">pj_pcap_filter</a> *&nbsp;</td>
          <td class="paramname"> <em>filter</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Configure filter for reading the file. When filter is configured, only packets matching all the filter settings will be returned.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>file</em>&nbsp;</td><td>PCAP file handle. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>filter</em>&nbsp;</td><td>The filter.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>PJ_SUCCESS on success, or the appropriate error code. </dd></dl>

</div>
</div>
</div>
<p>&nbsp;</p>
<hr><center>
PJLIB-UTIL Open Source, small footprint, and portable asynchronous/caching DNS resolver, text scanner, STUN client, and XML library<br>
Copyright (C) 2006-2009 Teluu Inc.
</center>


<!--#include virtual="/footer.html" -->

</BODY>
</HTML>
