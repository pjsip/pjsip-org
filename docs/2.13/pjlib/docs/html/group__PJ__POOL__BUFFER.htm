<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Stack/Buffer Based Memory Pool Allocator (2.13)</title>
<link href="/style/style.css" rel="stylesheet" type="text/css">
</head><body>
	<!--#include virtual="/header.html" -->
	<p><A HREF="/">Home</A> --&gt; <A HREF="/docs.htm">Documentations</A> --&gt; PJLIB Reference</p>
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Stack/Buffer Based Memory Pool Allocator<div class="ingroups"><a class="el" href="group__PJ__POOL__GROUP.htm">Fast Memory Pool</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Stack/buffer based pool.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gae87f3265aa0ea22a229f138278166ff2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structpj__pool__t.htm">pj_pool_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PJ__POOL__BUFFER.htm#gae87f3265aa0ea22a229f138278166ff2">pj_pool_create_on_buf</a> (const char *name, void *buf, <a class="el" href="group__PJ__BASIC.htm#ga9fdb3ceb491cd888cd30ca30d78026e8">pj_size_t</a> size)</td></tr>
<tr class="separator:gae87f3265aa0ea22a229f138278166ff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >Stack/buffer based pool. </p>
<p >This section describes an implementation of memory pool which uses memory allocated from the stack. Application creates this pool by specifying a buffer (which can be allocated from static memory or stack variable), and then use normal pool API to access/use the pool.</p>
<p >If the buffer specified during pool creation is a buffer located in the stack, the pool will be invalidated (or implicitly destroyed) when the execution leaves the enclosing block containing the buffer. Note that application must make sure that any objects allocated from this pool (such as mutexes) have been destroyed before the pool gets invalidated.</p>
<p >Sample usage:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;pjlib.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> test()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> buffer[500];</div>
<div class="line">  <a class="code hl_struct" href="structpj__pool__t.htm">pj_pool_t</a> *pool;</div>
<div class="line">  <span class="keywordtype">void</span> *p;</div>
<div class="line"> </div>
<div class="line">  pool = <a class="code hl_function" href="group__PJ__POOL__BUFFER.htm#gae87f3265aa0ea22a229f138278166ff2">pj_pool_create_on_buf</a>(<span class="stringliteral">&quot;thepool&quot;</span>, buffer, <span class="keyword">sizeof</span>(buffer));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Use the pool as usual</span></div>
<div class="line">  p = <a class="code hl_function" href="group__PJ__POOL.htm#ga14798f6ba0d0858e4f36cc8a4904bbd9">pj_pool_alloc</a>(pool, ...);</div>
<div class="line">  ...</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// No need to release the pool</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  <a class="code hl_function" href="group__PJ__BASIC.htm#ga069615152140fa2df009cebc8a36b769">pj_init</a>();</div>
<div class="line">  test();</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__PJ__BASIC_htm_ga069615152140fa2df009cebc8a36b769"><div class="ttname"><a href="group__PJ__BASIC.htm#ga069615152140fa2df009cebc8a36b769">pj_init</a></div><div class="ttdeci">pj_status_t pj_init(void)</div></div>
<div class="ttc" id="agroup__PJ__POOL__BUFFER_htm_gae87f3265aa0ea22a229f138278166ff2"><div class="ttname"><a href="group__PJ__POOL__BUFFER.htm#gae87f3265aa0ea22a229f138278166ff2">pj_pool_create_on_buf</a></div><div class="ttdeci">pj_pool_t * pj_pool_create_on_buf(const char *name, void *buf, pj_size_t size)</div></div>
<div class="ttc" id="agroup__PJ__POOL_htm_ga14798f6ba0d0858e4f36cc8a4904bbd9"><div class="ttname"><a href="group__PJ__POOL.htm#ga14798f6ba0d0858e4f36cc8a4904bbd9">pj_pool_alloc</a></div><div class="ttdeci">void * pj_pool_alloc(pj_pool_t *pool, pj_size_t size)</div></div>
<div class="ttc" id="astructpj__pool__t_htm"><div class="ttname"><a href="structpj__pool__t.htm">pj_pool_t</a></div><div class="ttdef"><b>Definition:</b> pool.h:310</div></div>
</div><!-- fragment --> <h2 class="groupheader">Function Documentation</h2>
<a id="gae87f3265aa0ea22a229f138278166ff2" name="gae87f3265aa0ea22a229f138278166ff2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae87f3265aa0ea22a229f138278166ff2">&#9670;&nbsp;</a></span>pj_pool_create_on_buf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpj__pool__t.htm">pj_pool_t</a> * pj_pool_create_on_buf </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__PJ__BASIC.htm#ga9fdb3ceb491cd888cd30ca30d78026e8">pj_size_t</a>&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Create the pool using the specified buffer as the pool's memory. Subsequent allocations made from the pool will use the memory from this buffer.</p>
<p >If the buffer specified in the parameter is a buffer located in the stack, the pool will be invalid (or implicitly destroyed) when the execution leaves the enclosing block containing the buffer. Note that application must make sure that any objects allocated from this pool (such as mutexes) have been destroyed before the pool gets invalidated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Optional pool name. </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer to be used by the pool. </td></tr>
    <tr><td class="paramname">size</td><td>The size of the buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The memory pool instance. </dd></dl>

</div>
</div>
</div><!-- contents -->
<p>&nbsp;</p>
<hr><center>
PJLIB Open Source, high performance, small footprint, and very very portable framework<br>
Copyright (C) 2006-2009 Teluu Inc.
</center>
<!--#include virtual="/footer.html" -->
</BODY>
</HTML>
